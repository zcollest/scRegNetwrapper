Sys.setenv(RETICULATE_PYTHON = "/usr/bin/python3")
library(reticulate)
source_python("/home/ubuntu/code/analysaurus/analysaurus/projects/tf_networks/notebooks/Python/pyscenic_wrapper_function.py")
Sys.setenv(RETICULATE_PYTHON = "/usr/bin/python3")
library(reticulate)
source_python("/home/ubuntu/code/analysaurus/analysaurus/projects/tf_networks/notebooks/Python/pyscenic_wrapper_function.py")
Sys.setenv(RETICULATE_PYTHON = "/usr/bin/python3")
library(reticulate)
# do pip install pyscenic==0.11.1, pip install dask==2.30.0, pip install distributed==2.30.0
source_python("/home/ubuntu/code/analysaurus/analysaurus/projects/tf_networks/notebooks/Python/pyscenic_wrapper_function.py")
setwd("/home/ubuntu/code/analysaurus/analysaurus/utils/scRegNetwrapper/R")
library(devtools)
library(Seurat)
library(tidyr)
library(RColorBrewer)
library(dplyr)
library(readxl)
library(progeny)
library(dorothea)
setwd("/home/ubuntu/code/analysaurus/analysaurus/utils/scRegNetwrapper/R")
setwd("/home/ubuntu/code/analysaurus/analysaurus/utils/scRegNetwrapper")
source_python("../Python/pyscenic_wrapper_function.py")
setwd("/home/ubuntu/code/analysaurus/analysaurus/utils")
source_python("scRegNetwrapper/Python/pyscenic_wrapper_function.py")
source_python("/scRegNetwrapper/Python/pyscenic_wrapper_function.py")
setwd("/home/ubuntu/code/analysaurus/analysaurus/utils/scRegNetwrapper")
setwd("/home/ubuntu/code/analysaurus/analysaurus/utils")
source_python("scRegNetwrapper/Python/run_pySCENIC.py")
setwd("/home/ubuntu/code/analysaurus/analysaurus/utils/scRegNetwrapper/Python")
source_python("scRegNetwrapper/Python/run_pySCENIC.py")
setwd("/home/ubuntu/code/analysaurus/analysaurus/utils")
source_python("scRegNetwrapper/Python/run_pySCENIC.py")
rm(pyscenic)
source_python("scRegNetwrapper/Python/run_pySCENIC.py")
setwd("/home/ubuntu/code/analysaurus/analysaurus/utils/scRegNetwrapper")
document()
setwd("/home/ubuntu/code/analysaurus/analysaurus/utils/scRegNetwrapper")
setwd("/home/ubuntu/code/analysaurus/analysaurus/utils/scRegNetwrapper/inst")
("run_pySCENIC.py")
source_python("run_pySCENIC.py")
source_python((system.file("run_pySCENIC.py", package = "scRegNetwrapper")))
py_run_file((system.file("run_pySCENIC.py", package = "scRegNetwrapper")))
py_run_file(system.file("run_pySCENIC.py", package = "scRegNetwrapper"))
setwd("/home/ubuntu/code/analysaurus/analysaurus/utils/scRegNetwrapper")
document()
document()
install_github("zcollest/scRegNetwrapper",force=TRUE)
library(scRegNetwrapper)
run_pyscenic(outdir, anndata_path, loom_path, tfs_path, rank_db_path, motif_path, output_loom_path)
outdir = "/data/nst9scenicR"
anndata_path = '/cf/skin_healthy/tfnets/s_treg_harm_embeddings_dorothea_progeny.h5ad'
loom_path = "/data/scenic.loom"
tfs_path = "/data/SCENIC_data/pipeline_data/hs_hgnc_tfs.txt"
rank_db_path = "/data/SCENIC_data/pipeline_data/hg38__refseq-r80__500bp_up_and_100bp_down_tss.mc9nr.feather"
motif_path = "/data/SCENIC_data/pipeline_data/motifs-v9-nr.hgnc-m0.001-o0.0.tbl"
output_loom_path = "/data/scenic_output.loom"
run_pyscenic(outdir, anndata_path, loom_path, tfs_path, rank_db_path, motif_path, output_loom_path)
run_pyscenic(outdir, anndata_path, loom_path, tfs_path, rank_db_path, motif_path, output_loom_path)
outdir = "/data"
anndata_path = '/cf/skin_healthy/tfnets/s_treg_harm_embeddings_dorothea_progeny.h5ad'
loom_path = "/data/scenic.loom"
tfs_path = "/data/SCENIC_data/pipeline_data/hs_hgnc_tfs.txt"
rank_db_path = "/data/SCENIC_data/pipeline_data/hg38__refseq-r80__500bp_up_and_100bp_down_tss.mc9nr.feather"
motif_path = "/data/SCENIC_data/pipeline_data/motifs-v9-nr.hgnc-m0.001-o0.0.tbl"
output_loom_path = "/data/scenic_output.loom"
run_pyscenic(outdir, anndata_path, loom_path, tfs_path, rank_db_path, motif_path, output_loom_path)
install.packages("usethis")
install.packages("usethis")
setwd("/home/ubuntu/code/analysaurus/analysaurus/utils/scRegNetwrapper")
use_package("dplyr")
library(usethis)
use_package("dplyr")
use_package("dplyr","Seurat","corrplot","effsize")
use_package(c("dplyr","Seurat","corrplot","effsize")
)
use_package("Seurat")
use_package("effsize")
use_package("corrplot")
use_package("dorothea")
use_package("progeny")
use_package("pheatmap")
use_package("reticulate")
use_package("tidyr")
import("tibble")
use_package("tibble")
document()
setwd("/home/ubuntu/code/analysaurus/analysaurus/utils/scRegNetwrapper")
document()
library(roxygen2)
document()
library(devtools)
document()
# Download and attach package
install_github("zcollest/scRegNetwrapper",force=TRUE)
library(devtools)
# Download and attach package
install_github("zcollest/scRegNetwrapper",force=TRUE)
library(scRegNetwrapper)
outdir = "/data"
anndata_path = '/cf/skin_healthy/tfnets/s_treg_harm_embeddings_dorothea_progeny.h5ad'
loom_path = "/data/scenic.loom"
tfs_path = "/data/SCENIC_data/pipeline_data/hs_hgnc_tfs.txt"
rank_db_path = "/data/SCENIC_data/pipeline_data/hg38__refseq-r80__500bp_up_and_100bp_down_tss.mc9nr.feather"
motif_path = "/data/SCENIC_data/pipeline_data/motifs-v9-nr.hgnc-m0.001-o0.0.tbl"
output_loom_path = "/data/scenic_output.loom"
run_pyscenic(outdir, anndata_path, loom_path, tfs_path, rank_db_path, motif_path, output_loom_path)
Sys.setenv(RETICULATE_PYTHON = "/usr/bin/python3")
library(reticulate)
run_pyscenic(outdir, anndata_path, loom_path, tfs_path, rank_db_path, motif_path, output_loom_path)
setwd("/home/ubuntu/code/analysaurus/analysaurus/utils/scRegNetwrapper")
document()
library(scRegNetwrapper)
run_pyscenic(outdir, anndata_path, loom_path, tfs_path, rank_db_path, motif_path, output_loom_path)
ad4r_hs <- readRDS('/cf/skin_disease/ad4r-hs.Rds')
Idents(ad4r_hs) <- ad4r_hs@meta.data$indication
ad4r_hs.subset <- subset(x = ad4r_hs, downsample = 500)
# clustering and looking at data
DefaultAssay(object = ad4r_hs.subset) <- "RNA"
ad4r_hs.subset <- FindNeighbors(ad4r_hs.subset, dims = 1:12, reduction = 'pca_harmony')
ad4r_hs.subset <- FindClusters(ad4r_hs.subset, resolution = 0.5)
DimPlot(ad4r_hs.subset,reduction = "umap")
results <- scRegNetwrapper(ad4r_hs.subset, dorothea_conf_scores = c("A"), topTFs=40, cores=15,
top_progeny_genes = 300, comparison_feature = ad4r_hs.subset@meta.data$donor)
library(progeny)
library(dorothea)
results <- scRegNetwrapper(ad4r_hs.subset, dorothea_conf_scores = c("A"), topTFs=40, cores=15,
top_progeny_genes = 300, comparison_feature = ad4r_hs.subset@meta.data$donor)
View(results)
results <- scRegNetwrapper(ad4r_hs.subset, dorothea_conf_scores = c("A"), topTFs=40, cores=15,
top_progeny_genes = 300, comparison_feature = ad4r_hs.subset@meta.data$indication)
View(results)
results[["dorothea_cohenD"]]
run_pyscenic(outdir, anndata_path, loom_path, tfs_path, rank_db_path, motif_path, output_loom_path)
reticulate::repl_python()
